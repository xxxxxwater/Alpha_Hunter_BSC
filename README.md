# Alpha Hunter - LI.FI版本

智能加密货币交易机器人，使用LI.FI聚合器获取最优价格，支持循环等待流动性和自动止盈。

## ✨ 核心特性

### 🎯 循环等待流动性（新币狙击利器）
- ✅ 检测不到流动性时，持续循环检测
- ✅ 发现流动性立即自动买入
- ✅ 专为新币开盘狙击设计
- ✅ 可配置检测间隔，支持随时中断

### 🔄 LI.FI聚合器
- ✅ 聚合所有主流DEX（PancakeSwap、Uniswap等）
- ✅ 自动获取最优价格和路径
- ✅ 降低滑点和交易成本

### 📈 智能止盈策略
- ✅ 2倍出本金（回本保护）
- ✅ 3倍出10%（锁定部分利润）
- ✅ 5倍出20%（加速盈利）
- ✅ 10倍出20%（高倍收益）

### 🛡️ 安全保障
- ✅ 多RPC节点自动切换
- ✅ API限流智能保护
- ✅ 余额检查和Gas预留
- ✅ 详细日志记录

## 🚀 快速开始

### 1. 环境准备

#### 安装Python（3.8或更高）
- Windows: https://www.python.org/downloads/
- 安装时勾选 "Add Python to PATH"

#### 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 配置环境

复制环境变量示例文件：
```bash
copy env_example.txt .env
```

编辑 `.env` 文件，填入必要信息：
```bash
# 钱包私钥（必填）
PRIVATE_KEY=your_private_key_here

# 每次投资金额（BNB）
INITIAL_INVESTMENT=0.035

# 滑点容忍度（10% = 0.10）
SLIPPAGE=0.15

# 最大持仓数量
MAX_POSITIONS=1

# 监控检查间隔（秒）
CHECK_INTERVAL=30
```

### 3. 启动程序

#### 方法1: 双击启动（推荐）
```
双击: 启动.bat
```

启动后会显示功能菜单：
```
============================================================
              Alpha Hunter - LI.FI版 v1.1.0
              智能交易机器人
============================================================

请选择功能:

  1. 启动交易程序
  2. 测试RPC连接
  3. 查看日志文件
  4. 查看持仓记录
  5. 退出

============================================================

请输入选项 (1-5):
```

#### 方法2: 命令行
```bash
python auto_trade_lifi.py
```

## 📖 使用场景

### 场景1: 新币开盘狙击 🎯

适用于：新币即将添加流动性，需要第一时间买入

**操作步骤**：
```
1. 启动程序
2. 输入代币地址
3. 检测不到流动性时，选择"循环等待模式"
4. 设置检测间隔（推荐15-30秒）
5. 程序自动循环检测，发现流动性立即买入
```

**实战示例**：
```
============================================================
[警告] 未检测到流动性池
============================================================

选项:
  1. 退出程序
  2. 循环等待流动性出现（推荐新币）← 选择这个
  3. 忽略并继续尝试买入

请选择 (1/2/3): 2

检测间隔（秒，默认30）: 15

[模式] 循环等待模式
[间隔] 每 15秒 检测一次
[提示] 按 Ctrl+C 可随时停止

[RETRY] 第 1 次尝试...
[WAIT] 未检测到流动性池，等待 15秒后重试...

[RETRY] 第 2 次尝试...
...

[RETRY] 第 20 次尝试...
[OK] 报价成功! ← 检测到流动性！
[RECEIVE] 预计获得: 10000000 代币
[SIGN] 签名交易...
[OK] 买入成功! 🎉
```

### 场景2: 交易已有流动性代币

适用于：代币已上线，有稳定流动性

**操作步骤**：
```
1. 启动程序
2. 输入代币地址
3. 查看价格预览
4. 确认买入
5. 程序自动监控止盈
```

### 场景3: 测试RPC连接

在交易前，建议先测试网络连接：

```bash
# 方法1: 使用启动菜单
双击 启动.bat → 选择"2. 测试RPC连接"

# 方法2: 命令行
python test_rpc_connection.py
```

测试结果示例：
```
============================================================
BSC RPC 连接测试工具
============================================================

测试公共RPC节点...

节点                                               状态     延迟         信息
--------------------------------------------------------------------------------
https://bsc-dataseed.binance.org                  ✅       156ms       区块高度: 35,123,456
https://bsc-dataseed1.defibit.io                  ✅       234ms       区块高度: 35,123,456
https://bsc.publicnode.com                        ✅       189ms       区块高度: 35,123,456

🎯 推荐使用: https://bsc-dataseed.binance.org
   延迟: 156ms (最快)

✅ 多个节点可用，程序可以正常运行！
```

## 📊 检测间隔建议

| 场景 | 检测间隔 | 每小时调用 | 说明 |
|------|---------|----------|------|
| 🔥 热门新币 | 15秒 | 240次 | 快速响应，竞争激烈 |
| ⭐ 普通新币 | 30秒 | 120次 | **推荐**，平衡性能 |
| 💤 低优先级 | 60秒 | 60次 | 节省资源 |
| 🐢 长期等待 | 120秒 | 30次 | 最低频率 |

## 🛠️ 工具说明

### test_rpc_connection.py
测试所有RPC节点的连接状态和速度

**功能**：
- ✅ 测试所有公共RPC节点
- ✅ 显示连接延迟
- ✅ 推荐最快节点
- ✅ 显示区块高度

**使用**：
```bash
python test_rpc_connection.py
```

## ⚠️ 重要提示

### 安全建议
- 🔒 不要分享你的私钥
- 🔒 不要上传 `.env` 文件到GitHub
- 🔒 建议使用测试钱包进行初次测试
- 🔒 只投入你能承受损失的资金

### 风险提示
- ⚠️ 加密货币交易有风险
- ⚠️ 新币风险更高，可能归零
- ⚠️ 程序不保证盈利
- ⚠️ 请理解并接受可能的损失

### 性能优化
- 💡 使用专业RPC服务获得更好性能
- 💡 检测间隔不低于30秒（避免API限流）
- 💡 保持钱包有充足BNB余额（含Gas费）
- 💡 监控日志，及时发现问题

## 📁 项目结构

```
binance_ALPHA/
├── alpha_hunter_lifi.py          # 核心交易引擎
├── auto_trade_lifi.py            # 启动脚本
├── test_rpc_connection.py        # RPC测试工具
├── requirements.txt              # 依赖列表
├── .env                          # 配置文件（需自行创建）
├── env_example.txt               # 配置示例
├── 启动.bat                      # Windows统一启动脚本
├── positions.json                # 持仓记录（自动生成）
├── alpha_hunter.log              # 运行日志（自动生成）
├── README.md                     # 本文件
├── 版本说明.txt                  # 版本信息
├── 循环等待流动性功能说明.md      # 详细功能说明
├── 新功能快速指南.txt            # 快速指南
└── 问题排查指南.md               # 故障排查
```

## 🔧 常见问题

### Q1: 无法连接到BSC节点？
**A**: 双击 `启动.bat` 选择"测试RPC连接"检查网络，或在 `.env` 中配置自定义RPC节点。

### Q2: 循环等待会一直运行吗？
**A**: 是的，直到检测到流动性或你按 `Ctrl+C` 中断。建议设置合理的检测间隔。

### Q3: API限流怎么办？
**A**: 程序内置限流保护。建议检测间隔设置为30秒以上，避免过度请求。

### Q4: 如何提高狙击成功率？
**A**: 
- 使用较短的检测间隔（15-30秒）
- 确保BNB余额充足
- 设置合理的滑点（10-20%）
- 使用快速的RPC节点

### Q5: 交易失败怎么办？
**A**: 查看日志文件 `alpha_hunter.log`，常见原因：
- BNB余额不足
- 滑点设置过低
- Gas费不足
- 代币合约问题

更多问题请查看 `问题排查指南.md`

## 📚 详细文档

| 文档 | 说明 |
|------|------|
| `循环等待流动性功能说明.md` | 循环等待功能完整说明 |
| `新功能快速指南.txt` | 快速上手指南 |
| `问题排查指南.md` | 常见问题和解决方案 |
| `env_example.txt` | 环境变量配置说明 |

## 🔄 工作流程

```
开始
  ↓
输入代币地址
  ↓
尝试获取流动性
  ├─→ 成功 → 显示价格 → 确认买入 → 执行交易
  │
  └─→ 失败 → 选择模式
             ├─→ 退出程序
             ├─→ 循环等待 ──┐
             │              │
             │    ┌─────────┘
             │    ↓
             │  每隔N秒检测
             │    ↓
             │  检测到流动性？
             │    ├─→ 否 → 继续等待
             │    └─→ 是 → 立即买入
             │              ↓
             └──────────→ 启动自动监控
                           ↓
                      实时监控价格
                           ↓
                      达到止盈点？
                           ├─→ 否 → 继续监控
                           └─→ 是 → 自动卖出
                                    ↓
                                 记录收益
                                    ↓
                                继续监控剩余持仓
```

## 🎯 止盈策略详解

| 阶段 | 倍数 | 卖出比例 | 说明 |
|------|------|---------|------|
| 🛡️ 回本 | 2x | 50% | 卖出一半回本，剩余是纯利润 |
| 💰 初步止盈 | 3x | 10% | 锁定部分收益 |
| 🚀 加速盈利 | 5x | 20% | 大幅盈利，落袋为安 |
| 🌟 高倍收益 | 10x | 20% | 顶级收益，继续持有剩余 |

**示例**：
```
初始投资: 0.025 BNB
购得代币: 1,000,000 个

价格涨2倍:
  持仓价值: 0.05 BNB
  卖出: 500,000 个代币 → 0.025 BNB（回本）
  剩余: 500,000 个代币（纯利润）

价格涨3倍:
  持仓价值: 0.075 BNB
  卖出: 50,000 个代币 → 0.0075 BNB
  剩余: 450,000 个代币

价格涨5倍:
  持仓价值: 0.125 BNB
  卖出: 90,000 个代币 → 0.025 BNB
  剩余: 360,000 个代币

价格涨10倍:
  持仓价值: 0.25 BNB
  卖出: 72,000 个代币 → 0.05 BNB
  剩余: 288,000 个代币（继续持有）

总收益: 0.1075 BNB + 288,000个代币
```

## 💻 系统要求

- **操作系统**: Windows 10/11, Linux, macOS
- **Python**: 3.8 或更高版本
- **内存**: 最低 512MB
- **网络**: 稳定的互联网连接
- **BNB余额**: 交易金额 + 0.005 BNB（Gas费预留）

## 📦 依赖包

```
web3>=6.0.0          # 以太坊/BSC交互
requests>=2.31.0     # HTTP请求
python-dotenv>=1.0.0 # 环境变量管理
eth-account>=0.8.0   # 账户管理
```

## 🌐 支持的网络

当前版本仅支持：
- ✅ BNB Smart Chain (BSC)

未来计划支持：
- ⏳ Ethereum
- ⏳ Polygon
- ⏳ Arbitrum
- ⏳ Avalanche

## 🔗 有用链接

- **BSCScan**: https://bscscan.com/
- **LI.FI**: https://li.fi/
- **PancakeSwap**: https://pancakeswap.finance/
- **BNB Chain**: https://www.bnbchain.org/

## 📞 获取帮助

遇到问题？
- 📖 查看 `问题排查指南.md`
- 📖 查看 `循环等待流动性功能说明.md`
- 💬 GitHub Issues
- 📧 技术支持

## 📈 版本历史

### v1.1.0 (2025-10-27) - 当前版本
- ✅ 新增循环等待流动性功能
- ✅ 修复BSC节点连接问题
- ✅ 优化API限流保护
- ✅ 改进错误提示和日志
- ✅ 新增RPC测试工具

### v1.0.0 (2025-10-20)
- 初始版本发布
- LI.FI聚合器集成
- 基础自动止盈功能

## 📜 许可证

本项目仅供学习和研究使用。使用本软件进行交易的风险由用户自行承担。

## ⚠️ 免责声明

- 本软件按"原样"提供，不提供任何明示或暗示的保证
- 加密货币交易具有高风险，可能导致资金损失
- 作者不对使用本软件造成的任何损失负责
- 请确保你了解相关风险并能够承受可能的损失
- 在使用真实资金前，请先进行充分测试

## 🎉 开始使用

```bash
# 1. 配置环境变量
copy env_example.txt .env
# 编辑 .env 文件填入配置

# 2. 启动程序（推荐）
双击: 启动.bat

# 或使用命令行
python auto_trade_lifi.py
```

祝你交易顺利！🚀

---

**开发团队** | **最后更新**: 2025-10-27 | **版本**: v1.1.0
